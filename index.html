<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Bird - Dark Theme</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
      body {
            font-family: sans-serif;
            overflow: hidden;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #121212; /* Dark background */
        }
        #game-container {
             position: relative;
              /* Responsive: use percentages instead of fixed pixels */
             width: 95%;  /* Take up most of the screen width, leave some margin */
              max-width: 400px;  /* But don't exceed 400px on large screens */
              height: 90vh;   /* 90% of the viewport height */
             max-height: 600px;  /* Limit maximum height as well */
             border: 2px solid #ddd;   /* Light border for dark theme */
            background-color: #1e1e1e; /* Slightly lighter dark for contrast */
           overflow: hidden;

      }

       #bird {
           position: absolute;
          left: 12.5%;    /* Responsive positioning:  percentage-based  */
            top: 33.33%;    /* Keep the aspect ratio of the initial position */
          font-size: 7vw; /* Responsive font size */
            max-font-size: 30px;    /* maximum absolute  sizes  */
            color: #ffd700;  /* Brighter gold */
            z-index: 10;
           transform-origin: center;
          }

     .pipe {
        position: absolute;
         width: 15%;       /* Responsive: Use a percentage of the game container */
          max-width: 60px;  /*  limit max absolute width, like the original */
        background-color: #4CAF50;
       box-sizing: border-box;

         left: 100%;       /* Starts fully off-screen to the right. */
         border: 3px solid #2E7D32;
           border-radius: 5px;
     }

        .pipe-top {
            top: 0;
       }

        .pipe-bottom {
            bottom: 0;
        }

     #top-bar {
        position: absolute;
        top: 0;
        left: 0;
         width: 100%;
         height: auto; /* Height based on content (better for varying font sizes) */
           background-color: rgba(0, 0, 0, 0.5);
          color: white;
           display: flex;
            justify-content: space-between;
           align-items: center;
           padding: 2% 2%; /* Responsive padding */
          z-index: 10;
          box-sizing: border-box;
       }
     #score-display, #rocket-count-display {
       display: flex;
        align-items: center;

            font-size: 4vw; /* Responsive: */

         max-font-size: 18px;
      }
   #score-display i, #rocket-count-display i {

        margin-right: 5px;  /* Still needed, relative to text size*/

       font-size: 6vw;        /* icons font */

     max-font-size: 24px;   /* Max size on larger displays  */

        }


      #game-over-screen {
            position: absolute;
            top: 50%;
            left: 50%;
          transform: translate(-50%, -50%);
           background-color: rgba(0, 0, 0, 0.7);
           color: white;
            padding: 20px;   /* You *could* make this responsive (e.g.,  4% 8%) */
          border-radius: 10px;
        display: none;

           z-index: 20;
         text-align: center;

        }
      #instructions {

             margin-bottom: 10px;

            font-size:  4vw;    /* Use vw */

              max-font-size: 16px;   /* Add the limit*/
          }


           #restart-button {
             margin-top: 10px;

               padding: 2vw 4vw;     /*  padding (percentages)  */
               font-size: 4vw;     /* text font size (percent)*/
            max-font-size: 16px;    /* With a reasonable absolute limit*/
             background-color: #4CAF50;
              color: white;

              border: none;
           border-radius: 5px;

               cursor: pointer; /* keep pointer, always useful.*/
       }


         #restart-button:hover {

            background-color: #3e8e41;
           }


         .rocket {
              position: absolute;
              width: 2.5%;         /* Make the rocket relatively sized  */

            max-width: 10px;     /* keep a sane maximum width */
             height: auto;        /* auto Height. height based on width + aspect */
          background-color: transparent;

            /* No transition for a smoother launch */

              z-index: 5;
        }
         .rocket i {

             color: red;

               font-size: 5vw;  /* Responsive, Use % (percentage), relative parent.*/
             max-font-size: 20px;   /* keep  good look*/

      }


      #final-score{

           font-size: 6vw;     /* Relative to viewport width  */

        max-font-size: 25px;

          font-weight: bold;
       }


   </style>
</head>
<body>
    <div id="game-container">
        <div id="top-bar">
            <div id="score-display"><i class="fas fa-star"></i><span id="score-value">0</span></div>
            <div id="rocket-count-display"><i class="fas fa-rocket"></i><span id="rocket-value">0</span></div>
        </div>
        <div id="bird"><i class="fas fa-dove"></i></div>

        <div id="game-over-screen">
           <div id="instructions">
            Press 'Space' to jump, 'X' to shoot.
           </div>
          <h2>Game Over</h2>
            <p id="final-score"></p>
          <button id="restart-button">Restart</button>
        </div>
    </div>

     <script>

      const bird = document.getElementById('bird');
        const gameContainer = document.getElementById('game-container');
        const scoreDisplayValue = document.getElementById('score-value');
      const rocketCountDisplayValue = document.getElementById('rocket-value');
      const gameOverScreen = document.getElementById('game-over-screen');
         const finalScoreDisplay = document.getElementById('final-score');
         const restartButton = document.getElementById('restart-button');


    let birdY = 200;
    let birdVelocity = 0;
   const gravity = 0.5;
    const jumpStrength = -8;
     let gameLoopInterval;
      let pipeSpawnInterval;
      let score = 0;
        let isGameOver = false;
    let pipes = [];
   let pipeSpeed = 2;  // You *could* make this responsive, but tricky.  Best left alone
        let rockets = [];

      let rocketCount = 0;

      const ROCKET_SPEED = 8;  // Also fine to leave as a fixed value

   let pipesPassedForRocket = 0;
     let scoreToDisplay = 0;

   let rocketBoostTimeout = null;  // Vertical rocket boost



     function startGame() {

             isGameOver = false;

            birdY = gameContainer.offsetHeight * 0.3333; //Start correct , 33.3%
          birdVelocity = 0;

              score = 0;
                scoreToDisplay = 0; //Resets.

         rocketCount = 0; // Start 0

          pipesPassedForRocket = 0;  //Start correct
       scoreDisplayValue.textContent = "0";  //restart to start at value
         rocketCountDisplayValue.textContent =  "0";
      pipes = []; //pipes cleared

        rockets = [];  //Rockets cleared

        gameOverScreen.style.display = 'none';  //restart

         //clear pipe rockets on restar game, all pipes that existed at start time
          document.querySelectorAll('.pipe, .rocket').forEach(el => el.remove());
          // Clear previous timeout (important for restarting!)
          clearTimeout(rocketBoostTimeout);


            gameLoopInterval = setInterval(gameLoop, 20);

              pipeSpawnInterval = setInterval(spawnPipe, 1500);


                bird.style.top = birdY + 'px';

          bird.style.transform = 'rotate(0deg)'; // rotate. Reset
            }




    function jump() {
          if (!isGameOver) {
             birdVelocity = jumpStrength;
              bird.style.transform = 'rotate(-20deg)';

           }
      }



    function shootRocket() {
        if (!isGameOver && rocketCount > 0) {

              rocketCount--;
              rocketCountDisplayValue.textContent = rocketCount;


              const rocket = document.createElement('div');

             rocket.classList.add('rocket');
               rocket.innerHTML = '<i class="fas fa-rocket"></i>'; //Font awesome for rocket

            rocket.style.left = bird.offsetLeft + bird.offsetWidth + 'px'; //x

              rocket.style.top = bird.offsetTop + bird.offsetHeight / 2 + 'px'; //y
                gameContainer.appendChild(rocket);

        rockets.push({ element: rocket, x: parseFloat(rocket.style.left) });  // update internal rocket



        //  rocket boost, up bird in 150millis. Cleared, so no buggin fly bird

       clearTimeout(rocketBoostTimeout);
      birdVelocity = 0;   // Remove velocity
      rocketBoostTimeout = setTimeout(() => { birdVelocity = gravity; }, 150);
      }
         }

      function spawnPipe() {
          if (isGameOver) return;

            const gapHeight = gameContainer.offsetHeight * 0.25; // Responsive. GAP proportional

          const minPipeHeight = gameContainer.offsetHeight * 0.083; // 8.3 % min
             const maxPipeHeight = gameContainer.offsetHeight - gapHeight - minPipeHeight;

           const topPipeHeight = Math.floor(Math.random() * (maxPipeHeight - minPipeHeight + 1)) + minPipeHeight; //pipe, range

            const bottomPipeHeight = gameContainer.offsetHeight - gapHeight - topPipeHeight;  // Bottom height


              const topPipe = document.createElement('div');

         topPipe.classList.add('pipe', 'pipe-top');

          topPipe.style.height = `${topPipeHeight}px`; //actual pipe
           gameContainer.appendChild(topPipe);


             const bottomPipe = document.createElement('div');

                bottomPipe.classList.add('pipe', 'pipe-bottom'); // same  for class name


         bottomPipe.style.height = `${bottomPipeHeight}px`;  // Pipe botton
              gameContainer.appendChild(bottomPipe); //Display pipes bottom

            pipes.push({ top: topPipe, bottom: bottomPipe, x: gameContainer.offsetWidth });  // add object of array 'pipes' to all display.

         }



     function gameLoop() {

       if (isGameOver) return;

         //Bird rotation. Rotates the bird

           if (birdVelocity > 2) {
           bird.style.transform = 'rotate(45deg)';
              }

              else if (birdVelocity < -2) {
              bird.style.transform = 'rotate(-20deg)'; //rotate up bird

             }

              else {

            bird.style.transform = 'rotate(0deg)';  // Reset

        }

           birdVelocity += gravity;  // apply gravity  time, goes
          birdY += birdVelocity;     // bird position, to be

             bird.style.top = birdY + 'px';  // apply move style
         // colission floor or roof

          if (birdY + bird.offsetHeight > gameContainer.offsetHeight || birdY < 0) {  //top / buttom

              gameOver();  //colision bird Top /Bottom.

               }




            // Rockets managemnt loop. Manage all created

               for (let i = rockets.length - 1; i >= 0; i--)

         {
            rockets[i].x += ROCKET_SPEED; // forward. Rockets still moviing  horizontal forward to lest, always, as every element

                rockets[i].element.style.left = rockets[i].x + 'px';  //x, moves in screen to forward


                  for (let j = pipes.length - 1; j >= 0; j--) {  //collision -pipes,

                     if (rockets[i] && //rocket must still exists. Checks
                         rockets[i].x + rockets[i].element.offsetWidth > pipes[j].x && //collision. If so

                          rockets[i].x < pipes[j].x + pipes[j].top.offsetWidth && //check x, to inside betwee to colidde, pipes/roclet
                       (rockets[i].element.offsetTop < pipes[j].top.offsetHeight ||   //top/ rocket top

                       rockets[i].element.offsetTop + rockets[i].element.offsetHeight > gameContainer.offsetHeight - pipes[j].bottom.offsetHeight)) //height -

                       {
                            // Collision detectede between Rocket <===> pipes Top/Bottom
                           // removed.
                           pipes[j].top.remove();
                         pipes[j].bottom.remove();  //Bottom also removed, as logic of 1-1-2 eleements.

                           pipes.splice(j, 1); //pipes delete to arrat. Remove
                           // Rocket colideed removed. Rocket is colliding to. It is also get out and removed
                          rockets[i].element.remove();

                      rockets.splice(i,1); // also 'rockets array' element removed as collision

                             break;  // Rocket x1 at collision with pipe
                    }

               }



               // off to screen - to right , horizontal, X cordinates, right now


              if (rockets[i] && rockets[i].x > gameContainer.offsetWidth) {
                  rockets[i].element.remove(); //removed its DOM

                    rockets.splice(i, 1); //delete position too, get array , out position that represent of index x

                }

        }

      //Move pipes, Pipes travel. move from left to rigth, constinours
          for (let i = pipes.length - 1; i >= 0; i--)
            {
             pipes[i].x -= pipeSpeed;
             pipes[i].top.style.left = pipes[i].x + 'px';  //top
            pipes[i].bottom.style.left = pipes[i].x + 'px';  //bootton. Always going to x
            // colision. Pipes  collisions.

         if (
                bird.offsetLeft + bird.offsetWidth > pipes[i].x && //horitonzal, top
                bird.offsetLeft < pipes[i].x + pipes[i].top.offsetWidth && //

                   (birdY < pipes[i].top.offsetHeight || //Check to collide Vertical if top Y from User
                      birdY + bird.offsetHeight > gameContainer.offsetHeight - pipes[i].bottom.offsetHeight) // Y, down colision
          )
                 {

                 gameOver(); // colision user - pipe, GAME OVER, bird dies. Colission with top/ Bottom of pipes, vertical
              }



              if (pipes[i].x + pipes[i].top.offsetWidth < bird.offsetLeft && !pipes[i].scored) {
                   //If so  Pipes has been succes passesd. 1 full pipe passed
                   //pipe

                   pipes[i].scored = true;

             score++;  //increase the value
                 scoreToDisplay = score;
                 pipesPassedForRocket++;  // variable counter to gain and know to show a new rocketr. variable



                    if (pipesPassedForRocket >= 2) //Pipes to add another new rocket , if counter  >= to.
                    {

                        rocketCount++;
                      pipesPassedForRocket = 0;

                }



                     scoreDisplayValue.textContent = scoreToDisplay;   //update at all

                    rocketCountDisplayValue.textContent = rocketCount; // rockets

               }



       //Pipes to remove pipes.  Loop pipes off screen
       if(pipes[i].x + pipes[i].top.offsetWidth < 0){
           pipes[i].top.remove();
           pipes[i].bottom.remove();
           pipes.splice(i,1);  // out element of general, object in all arrays to delete
            }
          }

         }

       function gameOver() {

     isGameOver = true;  // Game endend. All function checks isGame, is is set here, as collision game over


     clearInterval(gameLoopInterval);  //clearInterval as a game in proggress

           clearInterval(pipeSpawnInterval);    // set and interval

      // Display final scores
         finalScoreDisplay.textContent = "Final Score: " + scoreToDisplay; //final

             gameOverScreen.style.display = "block"; // Display game

            //Clear time on game. clear rocket interval on reset.

           clearTimeout(rocketBoostTimeout); // cleared rockets.

              }


             document.addEventListener('keydown', (event) => {   //key interactioon space
                 if (event.code === 'Space') {  //
              jump();  // Jump if no GAme oever
            }

             else if (event.code === 'KeyX'){  //press key X for rockeys

                  shootRocket(); //Shot
                }
     });




               document.addEventListener('touchstart', (event) => {

                    //
                  if(event.target == gameContainer || event.target == bird){
                   jump();  //  touch devices can use only
                     }

               });



               restartButton.addEventListener('click', startGame);


                startGame();



        </script>
    </body>
</html>
